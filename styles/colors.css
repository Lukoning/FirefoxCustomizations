/* Copyright (c) 2025 Lukoning (https://github.com/Lukoning) */

html, * {
    --color-accent-primary: light-dark(
        oklch(from AccentColor calc(l * 0.9) calc(c * 1.2) h),
        oklch(from AccentColor calc(l * 1.3) calc(c * 1.2) h)
    );
    --color-accent-primary-hover: color-mix(in oklch, white 15%, var(--color-accent-primary));
    --color-accent-primary-active: color-mix(in oklch, black 10%, var(--color-accent-primary));
    accent-color: var(--color-accent-primary);
    --button-text-color: currentColor;
    --button-text-color-primary: light-dark(white, black);
    --button-text-color-primary-hover: var(--button-text-color-primary);
    --button-text-color-primary-active: color-mix(in oklch, transparent 30%, var(--button-text-color-primary));
    --button-background-color: light-dark(
        color-mix(in oklch, currentColor 10%, transparent),
        color-mix(in oklch, currentColor 15%, transparent)
    );
    --button-background-color-hover: light-dark(
        color-mix(in oklch, currentColor 5%, transparent),
        color-mix(in oklch, currentColor 10%, transparent)
    );
    --button-background-color-active: light-dark(
        color-mix(in oklch, var(--color-accent-primary) 20%, transparent),
        color-mix(in oklch, var(--color-accent-primary) 30%, transparent)
    );
    --button-background-color-primary: var(--color-accent-primary);
    --button-background-color-primary-hover: var(--color-accent-primary-hover);
    --button-background-color-primary-active: var(--color-accent-primary-active);
    --button-background-color-ghost: transparent;
    --button-background-color-ghost-hover: var(--button-background-color);
    --button-background-color-ghost-active: var(--button-background-color-active);
    --in-content-primary-button-text-color: var(--button-text-color-primary);
    --in-content-primary-button-text-color-hover: var(--button-text-color-primary-hover);
    --in-content-primary-button-text-color-active: var(--button-text-color-primary-active);
    --in-content-primary-button-background: var(--color-accent-primary);
    --in-content-primary-button-background-hover: var(--color-accent-primary-hover);
    --in-content-primary-button-background-active: var(--color-accent-primary-active);
    --uei-button-bgcolor: var(--button-background-color-ghost);
    --uei-button-hover-bgcolor: var(--button-background-color-ghost-hover);
    --uei-button-active-bgcolor: var(--button-background-color-ghost-active);
    --toolbarbutton-background: transparent;
    --toolbarbutton-hover-background: var(--button-background-color);
    --toolbarbutton-active-background: var(--button-background-color-active);
    --toolbarbutton-icon-fill: var(--button-text-color);
    --toolbarbutton-icon-fill-attention: var(--color-accent-primary);
    --toolbarbutton-icon-fill-attention-text: var(--button-text-color-primary);
    --urlbarView-hover-background: var(--button-background-color);
    --urlbarView-highlight-color: var(--button-text-color);
    --urlbarView-highlight-background: color-mix(in oklch, var(--color-accent-primary) 30%, transparent);
    --urlbar-box-bgcolor: light-dark(#2221, #FFF1);
    --urlbar-box-hover-bgcolor: var(--toolbarbutton-hover-background);
    --urlbar-box-active-bgcolor: var(--toolbarbutton-active-background);
    --panel-border-color: #0002;
    --arrowpanel-border-color: var(--panel-border-color);
    --link-color: var(--color-accent-primary);
    --link-color-hover: var(--color-accent-primary-hover);
    --link-color-active: var(--color-accent-primary-active);
    --link-color-visited: oklch(from var(--color-accent-primary) l c calc(h + 80));
    ::selection {
        color: var(--button-text-color) !important;
        background: light-dark(
            color-mix(in oklch, var(--color-accent-primary) 30%, transparent),
            color-mix(in oklch, var(--color-accent-primary) 40%, transparent)
        ) !important;
    }
}

button {
    border: none !important;
}

#tabbrowser-tabs {/*标签页*/
    .tabbrowser-tab[visuallyselected] .tab-background { /*背景*/
        background: color-mix(in oklch, var(--tab-selected-bgcolor) 70%, transparent) !important;
    }
    &:not([orient="vertical"]) .tabbrowser-tab[visuallyselected] .tab-background {
        border-top: 2px solid var(--color-accent-primary);/*横向标签页上边框*/
    }
    &[orient="vertical"] { /*垂直标签页*/
        .tabbrowser-tab[visuallyselected] .tab-background {
            border-left: 2px solid var(--color-accent-primary);/*左侧垂直标签页左边框*/
        }
    }
}

#TabsToolbar #firefox-view-button { /*标签页栏FFView*/
    &:hover > :is(.toolbarbutton-icon, .toolbarbutton-text, .toolbarbutton-badge-stack) {
        background-color: var(--tab-hover-background-color) !important;
    }
    &[open] > .toolbarbutton-icon {
        background: color-mix(in oklch, var(--tab-selected-bgcolor) 70%, transparent) !important;
        border-top: 2px solid var(--color-accent-primary);/*打开时上边框*/
        padding-top: calc(var(--toolbarbutton-inner-padding) - 2px) !important;/*抵消上边框，防止图标变形*/
    }
}

#sidebar-box browser#sidebar { /*侧栏应用-背景*/
    background-color: color-mix(in oklch, -moz-sidebar 35%, transparent) !important;
}

@media (-moz-windows-accent-color-in-titlebar) or (-moz-windows-mica) {
    & {/*浏览器背景透明*/
        #browser, .browser-toolbar {
            background-color: transparent !important;
        }
        #tabbrowser-tabpanels {
            background: transparent !important;
        }
        @-moz-document url(about:blank) {
            #tabbrowser-tabpanels .deck-selected browser {
                opacity: 0;
            }
        }
    }
}